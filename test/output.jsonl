==============================
Request:
--

GET /notes/by-org?org_id=alice HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 170
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":3,"owner":"alice","title":"example"},{"content":"","id":5,"owner":"alice","title":"example"},{"content":"","id":6,"owner":"alice","title":"example"}]

==============================
==============================
Request:
--

GET /notes/by-org?org_id=alice HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 170
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":3,"owner":"alice","title":"example"},{"content":"","id":5,"owner":"alice","title":"example"},{"content":"","id":6,"owner":"alice","title":"example"}]

==============================
==============================
Request:
--

GET /notes/by-org?org_id=bob HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 164
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":4,"owner":"bob","title":"example"},{"content":"","id":7,"owner":"bob","title":"example"},{"content":"","id":8,"owner":"bob","title":"example"}]

==============================
==============================
Request:
--

GET /notes/by-org?org_id=bob HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 164
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":4,"owner":"bob","title":"example"},{"content":"","id":7,"owner":"bob","title":"example"},{"content":"","id":8,"owner":"bob","title":"example"}]

==============================
==============================
Request:
--

POST /notes/secure-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 35

{
  "owner": "alice",
  "title": "example"
}

Response:
--
HTTP/1.1 201 Created
Content-Length: 56
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"content":"","id":9,"owner":"alice","title":"example"}

==============================
==============================
Request:
--

POST /notes/secure-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 35

{
  "owner": "alice",
  "title": "example"
}

Response:
--
HTTP/1.1 403 Forbidden
Content-Length: 37
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"forbidden_owner_mismatch"}

==============================
==============================
Request:
--

POST /notes/secure-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 33

{
  "owner": "bob",
  "title": "example"
}

Response:
--
HTTP/1.1 201 Created
Content-Length: 55
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"content":"","id":10,"owner":"bob","title":"example"}

==============================
==============================
Request:
--

POST /notes/secure-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 33

{
  "owner": "bob",
  "title": "example"
}

Response:
--
HTTP/1.1 403 Forbidden
Content-Length: 37
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"forbidden_owner_mismatch"}

==============================
==============================
Request:
--

GET /users/alice/notes HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 226
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":3,"owner":"alice","title":"example"},{"content":"","id":5,"owner":"alice","title":"example"},{"content":"","id":6,"owner":"alice","title":"example"},{"content":"","id":9,"owner":"alice","title":"example"}]

==============================
==============================
Request:
--

GET /users/alice/notes HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 403 Forbidden
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"forbidden"}

==============================
==============================
Request:
--

GET /users/bob/notes HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 219
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":4,"owner":"bob","title":"example"},{"content":"","id":7,"owner":"bob","title":"example"},{"content":"","id":8,"owner":"bob","title":"example"},{"content":"","id":10,"owner":"bob","title":"example"}]

==============================
==============================
Request:
--

GET /users/bob/notes HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 403 Forbidden
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"forbidden"}

==============================
==============================
Request:
--

http://localhost:8080/notes - skipped - no object identifiers referenced by this operation

==============================
==============================
Request:
--

http://localhost:8080/notes - skipped - no object identifiers referenced by this operation

==============================
==============================
Request:
--

GET /notes/by-org/secure?org_id=alice HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 226
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":3,"owner":"alice","title":"example"},{"content":"","id":5,"owner":"alice","title":"example"},{"content":"","id":6,"owner":"alice","title":"example"},{"content":"","id":9,"owner":"alice","title":"example"}]

==============================
==============================
Request:
--

GET /notes/by-org/secure?org_id=alice HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 403 Forbidden
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"forbidden"}

==============================
==============================
Request:
--

GET /notes/by-org/secure?org_id=bob HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 200 OK
Content-Length: 219
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

[{"content":"","id":4,"owner":"bob","title":"example"},{"content":"","id":7,"owner":"bob","title":"example"},{"content":"","id":8,"owner":"bob","title":"example"},{"content":"","id":10,"owner":"bob","title":"example"}]

==============================
==============================
Request:
--

GET /notes/by-org/secure?org_id=bob HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 403 Forbidden
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"forbidden"}

==============================
==============================
Request:
--

http://localhost:8080/health - skipped - no security requirement

==============================
==============================
Request:
--

PUT /notes/1/vuln HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 17

{
  "owner": "alice"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/1/vuln HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 17

{
  "owner": "alice"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/2/vuln HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 15

{
  "owner": "bob"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/2/vuln HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 15

{
  "owner": "bob"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

POST /notes/vuln-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 35

{
  "owner": "alice",
  "title": "example"
}

Response:
--
HTTP/1.1 201 Created
Content-Length: 57
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"content":"","id":11,"owner":"alice","title":"example"}

==============================
==============================
Request:
--

POST /notes/vuln-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 35

{
  "owner": "alice",
  "title": "example"
}

Response:
--
HTTP/1.1 201 Created
Content-Length: 57
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"content":"","id":12,"owner":"alice","title":"example"}

==============================
==============================
Request:
--

POST /notes/vuln-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 33

{
  "owner": "bob",
  "title": "example"
}

Response:
--
HTTP/1.1 201 Created
Content-Length: 55
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"content":"","id":13,"owner":"bob","title":"example"}

==============================
==============================
Request:
--

POST /notes/vuln-owner HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 33

{
  "owner": "bob",
  "title": "example"
}

Response:
--
HTTP/1.1 201 Created
Content-Length: 55
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"content":"","id":14,"owner":"bob","title":"example"}

==============================
==============================
Request:
--

GET /notes/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

GET /notes/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

GET /notes/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

GET /notes/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 17

{
  "owner": "alice"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 17

{
  "owner": "alice"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_BOB
Content-Length: 15

{
  "owner": "bob"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

PUT /notes/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
Content-Type: application/json
X-API-Key: KEY_ALICE
Content-Length: 15

{
  "owner": "bob"
}

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

DELETE /notes/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

DELETE /notes/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

DELETE /notes/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_BOB
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
==============================
Request:
--

DELETE /notes/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
X-API-Key: KEY_ALICE
Content-Length: 0

Response:
--
HTTP/1.1 404 Not Found
Content-Length: 22
Content-Type: application/json
Date: Wed, 10 Sep 2025 17:43:48 GMT
Server: Werkzeug/3.1.3 Python/3.11.13

{"error":"not_found"}

==============================
